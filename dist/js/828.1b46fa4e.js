"use strict";(self["webpackChunkrock_sugar"]=self["webpackChunkrock_sugar"]||[]).push([[828],{6828:function(s,t,a){a.r(t),a.d(t,{default:function(){return m}});var i=a(3396);function e(s,t,a,e,c,o){const r=(0,i.up)("nano_cg_experiment_page");return(0,i.wg)(),(0,i.j4)(r,{prop_des_data:c.desData,prop_ui_setter:o.uiSetter,prop_section_params:c.sectionParams,ref:"page"},null,8,["prop_des_data","prop_ui_setter","prop_section_params"])}a(7658);var c=a(2812),o=a(2042);const r={category:"Experiment",name:"3DHouse",buttonContent:"查看源码",title:"3DHouse",content:"3DHouse."};var n={name:"3DHouse",data(){return{canvas:null,ctx:null,desData:r,sectionParams:{nProjectionType:0,VRP:[0,0,0],Theta:0,Phi:0,Delta:0,PRP:[250,100,250],CW:[0,0],wcHouse:[],vcHouse:[],scHouse:[],lPRP:[],lwcWC:[],lscWC:[],lwcVRC:[],lvcVRC:[],lscVRC:[],lwcPRP:[],lvcPRP:[],lscPRP:[],MT:[],MP:[],debugContent:null,girdSize:2,color:"#000000",screenTransform:{x:50,y:120,scale:100},showModel:0}}},computed:{uiSetter(){let s=this.sectionParams,t=[{type:"slider",id:"girdSize",value:s.girdSize,min:1,max:100,callback:c.Z.globalUiCallbacks.updateValue(this,"girdSize")},{type:"slider",id:"showProjectionView",value:s.showModel,min:0,max:1,callback:c.Z.globalUiCallbacks.updateValue(this,"showModel")},{type:"slider",id:"Theta",value:s.Theta,min:0,max:360,callback:c.Z.globalUiCallbacks.updateValue(this,"Theta")},{type:"slider",id:"Phi",value:s.Phi,min:0,max:360,callback:c.Z.globalUiCallbacks.updateValue(this,"Phi")},{type:"slider",id:"Delta",value:s.Delta,min:0,max:360,callback:c.Z.globalUiCallbacks.updateValue(this,"Delta")},{type:"color",id:"color",default:s.color,callback:c.Z.globalUiCallbacks.updateValue(this,"color")},{type:"slider-vector",id:"PRP",value:s.PRP,min:{0:0,1:0,2:0},max:{0:500,1:500,2:500},callback:c.Z.globalUiCallbacks.updatePoint(this,"PRP")},{type:"slider-vector",id:"VRP",value:s.VRP,min:{0:0,1:0,2:0},max:{0:500,1:500,2:500},callback:c.Z.globalUiCallbacks.updatePoint(this,"VRP")}];return t}},mounted(){this.Init(),this.SetUI()},methods:{Init(){this.$refs.page.Init(),this.canvas=this.$refs.page.getCanvas(),this.ctx=canvas.getContext("2d"),this.$refs.page.setViewer(this.sectionParams.screenTransform,this.Render);let s=0,t=0;for(let i=0;i<14;i++)this.sectionParams.wcHouse.push([]),this.sectionParams.vcHouse.push([]),this.sectionParams.scHouse.push([]);for(let i=0;i<4;i++)this.sectionParams.lwcWC.push([]),this.sectionParams.lscWC.push([]),this.sectionParams.lwcVRC.push([]),this.sectionParams.lvcVRC.push([]),this.sectionParams.lscVRC.push([]),this.sectionParams.MT.push([]),this.sectionParams.MP.push([]);for(let i=0;i<2;i++)this.sectionParams.lwcPRP.push([]),this.sectionParams.lvcPRP.push([]),this.sectionParams.lscPRP.push([]);for(this.sectionParams.wcHouse[0][0]=20,this.sectionParams.wcHouse[0][1]=0,this.sectionParams.wcHouse[0][2]=0,this.sectionParams.wcHouse[1][0]=20,this.sectionParams.wcHouse[1][1]=0,this.sectionParams.wcHouse[1][2]=8,this.sectionParams.wcHouse[2][0]=20,this.sectionParams.wcHouse[2][1]=6,this.sectionParams.wcHouse[2][2]=8,this.sectionParams.wcHouse[3][0]=20,this.sectionParams.wcHouse[3][1]=9,this.sectionParams.wcHouse[3][2]=4,this.sectionParams.wcHouse[4][0]=20,this.sectionParams.wcHouse[4][1]=6,this.sectionParams.wcHouse[4][2]=0,this.sectionParams.wcHouse[5][0]=28,this.sectionParams.wcHouse[5][1]=4,this.sectionParams.wcHouse[5][2]=8,this.sectionParams.wcHouse[6][0]=28,this.sectionParams.wcHouse[6][1]=0,this.sectionParams.wcHouse[6][2]=8,s=7;s<14;s++)this.sectionParams.wcHouse[s][0]=this.sectionParams.wcHouse[s-7][0]+20,this.sectionParams.wcHouse[s][1]=this.sectionParams.wcHouse[s-7][1],this.sectionParams.wcHouse[s][2]=this.sectionParams.wcHouse[s-7][2],this.sectionParams.wcHouse[s][3]=1;this.sectionParams.wcHouse[12][0]=this.sectionParams.wcHouse[5][0]+4,this.sectionParams.wcHouse[13][0]=this.sectionParams.wcHouse[6][0]+4;let a=5;for(s=0;s<14;s++)this.sectionParams.wcHouse[s][0]=a*this.sectionParams.wcHouse[s][0],this.sectionParams.wcHouse[s][1]=a*this.sectionParams.wcHouse[s][1],this.sectionParams.wcHouse[s][2]=a*this.sectionParams.wcHouse[s][2];for(s=0;s<4;s++)for(t=0;t<3;t++)this.sectionParams.lwcWC[s][t]=0;for(this.sectionParams.lwcWC[0][0]=300,this.sectionParams.lwcWC[1][1]=100,this.sectionParams.lwcWC[2][2]=100,s=0;s<4;s++)for(t=0;t<3;t++)this.sectionParams.lwcVRC[s][t]=0;this.sectionParams.lwcVRC[0][0]=30,this.sectionParams.lwcVRC[1][1]=30,this.sectionParams.lwcVRC[2][2]=30,this.sectionParams.lPRP[0]=3e3,this.sectionParams.lPRP[1]=1e3,this.sectionParams.lPRP[2]=6e3,this.Render()},Render(){this.$refs.page.Render();const s=this.ctx,t=parseInt(this.canvas.width/this.sectionParams.girdSize)-1,a=parseInt(this.canvas.height/this.sectionParams.girdSize)-1;s.clearRect(0,0,this.canvas.width,this.canvas.height),this.sectionParams.girdSize+=this.$refs.page.girdSize,c.Z.drawGrid(this),this.sectionParams.girdSize<=0&&(this.sectionParams.girdSize=1),this.sectionParams.debugContent=[{title:"grid",content:"The number of cells in the x direction: "+t+"\nThe number of cells in the y direction: "+a}],c.Z.setScreenTransform(this.sectionParams.screenTransform),0==this.sectionParams.showModel?this.ShowLayout():1==this.sectionParams.showModel&&this.ShowProjection()},setProjectionType(s){this.sectionParams.nProjectionType=s},setVRP(s,t,a){this.sectionParams.VRP[0]=s,this.sectionParams.VRP[1]=t,this.sectionParams.VRP[2]=a},setAngle(s,t,a){this.sectionParams.Theta=s,this.sectionParams.Phi=t,this.sectionParams.Delta=a},setPRP(s,t,a){this.sectionParams.PRP[0]=s,this.sectionParams.PRP[1]=t,this.sectionParams.PRP[2]=a},setCW(s,t){this.sectionParams.CW[0]=s,this.sectionParams.CW[1]=t},ShowLayout(){let s,t;for(s=0;s<2;s++)for(t=0;t<3;t++)this.sectionParams.lwcPRP[s][t]=this.sectionParams.VRP[t]+this.sectionParams.PRP[t],this.sectionParams.lwcPRP[s][t]=this.sectionParams.VRP[t]+this.sectionParams.PRP[t];for(this.sectionParams.lwcPRP[1][1]=0,this.GenerateMatricTransform(this.sectionParams.VRP[0],this.sectionParams.VRP[1],this.sectionParams.VRP[2],this.sectionParams.Theta,this.sectionParams.Phi,this.sectionParams.Delta,this.sectionParams.MT),this.Transform(this.sectionParams.lwcVRC,this.sectionParams.lvcVRC,4,this.sectionParams.MT),this.Transform(this.sectionParams.lwcPRP,this.sectionParams.lvcPRP,2,this.sectionParams.MT),this.GenerateMatricProject(this.sectionParams.lPRP,this.sectionParams.MP,0),this.Project(this.sectionParams.wcHouse,this.sectionParams.scHouse,14,this.sectionParams.MP),this.Project(this.sectionParams.lwcWC,this.sectionParams.lscWC,4,this.sectionParams.MP),this.Project(this.sectionParams.lvcVRC,this.sectionParams.lscVRC,4,this.sectionParams.MP),this.Project(this.sectionParams.lvcPRP,this.sectionParams.lscPRP,2,this.sectionParams.MP),this.ToScreen(this.sectionParams.scHouse,14),this.ToScreen(this.sectionParams.lscWC,4),this.ToScreen(this.sectionParams.lscVRC,4),this.ToScreen(this.sectionParams.lscPRP,2),this.DrawHouse(),s=0;s<3;s++)c.Z.drawLineInGrid(this,new o.Z(this.sectionParams.lscWC[3][0],this.sectionParams.lscWC[3][1]),new o.Z(this.sectionParams.lscWC[s][0],this.sectionParams.lscWC[s][1]),this.sectionParams.color);for(s=0;s<3;s++)c.Z.drawLineInGrid(this,new o.Z(this.sectionParams.lscVRC[s][0],this.sectionParams.lscVRC[s][1]),new o.Z(this.sectionParams.lscVRC[3][0],this.sectionParams.lscVRC[3][1]),this.sectionParams.color);c.Z.drawEllipseInGrid(this,this.sectionParams.lscPRP[0][0]-3,this.sectionParams.lscPRP[0][1]-3,6,6),c.Z.drawLineInGrid(this,new o.Z(this.sectionParams.lscPRP[0][0],this.sectionParams.lscPRP[0][1]),new o.Z(this.sectionParams.lscPRP[1][0],this.sectionParams.lscPRP[1][1]),this.sectionParams.color)},ShowProjection(){this.GenerateMatricTransform(-this.sectionParams.VRP[0],-this.sectionParams.VRP[1],-this.sectionParams.VRP[2],-this.sectionParams.Theta,-this.sectionParams.Phi,-this.sectionParams.Delta,this.sectionParams.MT),this.Transform(this.sectionParams.wcHouse,this.sectionParams.vcHouse,14,this.sectionParams.MT),this.GenerateMatricProject(this.sectionParams.PRP,this.sectionParams.MP,this.sectionParams.nProjectionType),this.Project(this.sectionParams.vcHouse,this.sectionParams.scHouse,14,this.sectionParams.MP),this.ToScreen(this.sectionParams.scHouse,14),this.DrawHouse()},Transform(s,t,a,i){let e,c;for(e=0;e<a;e++)for(c=0;c<3;c++)t[e][c]=i[c][0]*s[e][0]+i[c][1]*s[e][1]+i[c][2]*s[e][2]+1*i[c][3]},Project(s,t,a,i){let e,c,o,r,n;for(e=0;e<a;e++)c=s[e][0]*i[0][0]+s[e][2]*i[0][2],o=s[e][1]*i[1][1]+s[e][2]*i[1][2],r=0,n=s[e][2]*i[3][2]+1,t[e][0]=Math.floor(c/n),t[e][1]=Math.floor(o/n)},ToScreen(s,t){let a;for(a=0;a<t;a++)s[a][1]=-s[a][1]},MatricMultiply(s,t,a){for(let i=0;i<4;i++)for(let e=0;e<4;e++)a[i][e]=s[i][0]*t[0][e]+s[i][1]*t[1][e]+s[i][2]*t[2][e]+s[i][3]*t[3][e]},GenerateMatricTransform(s,t,a,i,e,c,o){const r=Math.PI;let n,h,P=i*r/180,m=e*r/180,l=c*r/180,u=[],w=[],d=[],H=[],R=[];for(let p=0;p<4;p++)u.push([]),w.push([]),d.push([]),H.push([]),R.push([]);for(n=0;n<4;n++)for(h=0;h<4;h++)u[n][h]=0,d[n][h]=0,H[n][h]=0,w[n][h]=0,R[n][h]=0,o[n][h]=0;u[0][0]=1,u[0][3]=s,u[1][1]=1,u[1][3]=t,u[2][2]=1,u[2][3]=a,u[3][3]=1,w[0][0]=Math.cos(P),w[0][1]=-Math.sin(P),w[1][0]=Math.sin(P),w[1][1]=Math.cos(P),w[2][2]=1,w[3][3]=1,d[0][0]=Math.cos(m),d[0][2]=Math.sin(m),d[1][1]=1,d[2][0]=-Math.sin(m),d[2][2]=Math.cos(m),d[3][3]=1,H[0][0]=1,H[1][1]=Math.cos(l),H[1][2]=-Math.sin(l),H[2][1]=Math.sin(l),H[2][2]=Math.cos(l),H[3][3]=1,this.MatricMultiply(u,w,o),this.MatricMultiply(o,d,R),this.MatricMultiply(R,H,o)},GenerateMatricProject(s,t,a){0==a?(t[0][0]=1,t[0][1]=0,t[0][2]=-s[0]/s[2],t[0][3]=0,t[1][0]=0,t[1][1]=1,t[1][2]=-s[1]/s[2],t[1][3]=0,t[2][0]=0,t[2][1]=0,t[2][2]=0,t[2][3]=0,t[3][0]=0,t[3][1]=0,t[3][2]=-1/s[2],t[3][3]=1):1==a&&(t[0][0]=1,t[0][1]=0,t[0][2]=-(s[0]-CW[0])/s[2],t[0][3]=0,t[1][0]=0,t[1][1]=1,t[1][2]=-(s[1]-CW[1])/s[2],t[1][3]=0,t[2][0]=0,t[2][1]=0,t[2][2]=0,t[2][3]=0,t[3][0]=0,t[3][1]=0,t[3][2]=0,t[3][3]=1)},DrawHouse(){let s;for(s=0;s<5;s++)c.Z.drawLineInGrid(this,new o.Z(this.sectionParams.scHouse[s][0],this.sectionParams.scHouse[s][1]),new o.Z(this.sectionParams.scHouse[(s+1)%5][0],this.sectionParams.scHouse[(s+1)%5][1]),this.sectionParams.color);for(s=7;s<11;s++)c.Z.drawLineInGrid(this,new o.Z(this.sectionParams.scHouse[s][0],this.sectionParams.scHouse[s][1]),new o.Z(this.sectionParams.scHouse[s+1][0],this.sectionParams.scHouse[s+1][1]));for(c.Z.drawLineInGrid(this,new o.Z(this.sectionParams.scHouse[s][0],this.sectionParams.scHouse[s][1]),new o.Z(this.sectionParams.scHouse[7][0],this.sectionParams.scHouse[7][1]),this.sectionParams.color),s=0;s<6;s++)c.Z.drawLineInGrid(this,new o.Z(this.sectionParams.scHouse[s][0],this.sectionParams.scHouse[s][1]),new o.Z(this.sectionParams.scHouse[s+7][0],this.sectionParams.scHouse[s+7][1]));c.Z.drawLineInGrid(this,new o.Z(this.sectionParams.scHouse[5][0],this.sectionParams.scHouse[5][1]),new o.Z(this.sectionParams.scHouse[6][0],this.sectionParams.scHouse[6][1])),c.Z.drawLineInGrid(this,new o.Z(this.sectionParams.scHouse[12][0],this.sectionParams.scHouse[12][1]),new o.Z(this.sectionParams.scHouse[13][0],this.sectionParams.scHouse[13][1]))},SetUI(){this.$refs.page.SetUI()}}},h=a(89);const P=(0,h.Z)(n,[["render",e]]);var m=P}}]);
//# sourceMappingURL=828.1b46fa4e.js.map