"use strict";(self["webpackChunkrock_sugar"]=self["webpackChunkrock_sugar"]||[]).push([[106],{4483:function(t,i){class e{constructor(t){this.points=t,this.points.forEach(((t,i)=>{this[i]=t}))}maxPointX(){let t=0;return this.points.forEach((i=>{t=t>i.x?t:i.x})),t}minPointX(){let t=this.maxPointX();return this.points.forEach((i=>{t=t<i.x?t:i.x})),t}maxPointY(){let t=0;return this.points.forEach((i=>{t=t>i.y?t:i.y})),t}minPointY(){let t=this.maxPointX();return this.points.forEach((i=>{t=t<i.y?t:i.y})),t}size(){return this.points.length}indexValue(t){return this.points[t]}isInPolygon(t){let i,e,s=!1;for(i=0,e=this.size()-1;i<this.size();e=i++)this.points[i].y>t.y!=this.points[e].y>t.y&&t.x<(this.points[e].x-this.points[i].x)*(t.y-this.points[i].y)/(this.points[e].y-this.points[i].y)+this.points[i].x&&(s=!s);return s}}i["Z"]=e},5351:function(t,i,e){e.d(i,{Z:function(){return n}});var s=e(2482),r=e(2042);class n{constructor(t,i,e,r){(0,s.Z)(this,"left",0),(0,s.Z)(this,"right",0),(0,s.Z)(this,"top",0),(0,s.Z)(this,"bottom",0),this.left=t,this.right=i,this.top=e,this.bottom=r}X(){return this.left}Y(){return this.top}Height(){return this.bottom-this.top}Width(){return this.right-this.left}Left(){return this.left}Right(){return this.right}Top(){return this.top}Bottom(){return this.bottom}RectPoints(){return{leftTop:new r.Z(this.left,this.top),rightTop:new r.Z(this.right,this.top),leftBottom:new r.Z(this.left,this.bottom),rightBottom:new r.Z(this.right,this.bottom)}}Intersected(t){const i=t.left-this.left>0?t.left:this.left,e=t.right-this.right>0?this.right:t.right,s=t.top-this.top>0?t.top:this.top,r=t.bottom-this.bottom>0?this.bottom:t.bottom;return i>e||s>r?null:new n(i,e,s,r)}Scale(t){t<=0||(this.left*=t,this.right*=t,this.top*=t,this.bottom*=t)}}},7106:function(t,i,e){e.r(i),e.d(i,{default:function(){return d}});var s=e(3396);function r(t,i,e,r,n,o){const h=(0,s.up)("nano_cg_experiment_page");return(0,s.wg)(),(0,s.j4)(h,{prop_des_data:n.desData,prop_ui_setter:o.uiSetter,prop_section_params:n.sectionParams,ref:"page"},null,8,["prop_des_data","prop_ui_setter","prop_section_params"])}e(7658);var n=e(2812),o=e(5351),h=e(4483),a=e(2042);const l={category:"Experiment",name:"ClipPolygon",buttonContent:"查看源码",title:"多边形裁剪",content:"clip polygon."};var c={name:"ClipPolygon",data(){return{canvas:null,ctx:null,desData:l,sectionParams:{points:[{x:0,y:100},{x:100,y:10},{x:190,y:100},{x:100,y:50}],clipRect:new o.Z(20,100,20,100),innerColor:"#0bc6e3",outerColor:"#ffffff",clipColor:"#000000",debugContent:null,girdSize:3,screenTransform:{x:0,y:0,scale:100}}}},computed:{uiSetter(){let t=this.sectionParams,i=[{type:"slider",id:"girdSize",value:t.girdSize,min:1,max:100,callback:n.Z.globalUiCallbacks.updateValue(this,"girdSize")},{type:"color",id:"innerColor",default:t.innerColor,callback:n.Z.globalUiCallbacks.updateValue(this,"innerColor")},{type:"color",id:"outerColor",default:t.outerColor,callback:n.Z.globalUiCallbacks.updateValue(this,"outerColor")},{type:"color",id:"clipColor",default:t.clipColor,callback:n.Z.globalUiCallbacks.updateValue(this,"clipColor")}];for(let e=0;e<this.sectionParams.points.length;e++)i.push({type:"slider-vector",id:"point"+e,value:t.points[e],min:{x:0,y:0},max:{x:500,y:500},callback:n.Z.globalUiCallbacks.updatePointArray(this,"points",e)});return i}},methods:{Init(){this.$refs.page.Init(),this.canvas=this.$refs.page.getCanvas(),this.ctx=canvas.getContext("2d"),this.$refs.page.setViewer(this.sectionParams.screenTransform,this.Render),this.Render()},Render(){this.$refs.page.Render();const t=this.ctx,i=parseInt(this.canvas.width/this.sectionParams.girdSize)-1,e=parseInt(this.canvas.height/this.sectionParams.girdSize)-1;t.clearRect(0,0,this.canvas.width,this.canvas.height),this.sectionParams.girdSize+=this.$refs.page.girdSize,n.Z.drawGrid(this),this.sectionParams.girdSize<=0&&(this.sectionParams.girdSize=1),this.sectionParams.debugContent=[{title:"grid",content:"The number of cells in the x direction: "+i+"\nThe number of cells in the y direction: "+e}];const s=this.sectionParams.clipRect;n.Z.drawRectInGrid(this,s,this.sectionParams.clipColor),n.Z.drawPolygonInGrid(this,new h.Z(this.sectionParams.points),this.sectionParams.outerColor);const r=this.polyClip(new h.Z(this.sectionParams.points),this.sectionParams.clipRect);r.size()<3||n.Z.drawPolygonInGrid(this,r,this.sectionParams.innerColor)},polyClip(t,i){let e,s,r,n,o,h,l,c;return e=i.X(),s=i.Y()+i.Height(),r=i.X(),n=i.Y(),o=this.edgeClip(t,new a.Z(e,s),new a.Z(r,n)),e=i.X()+i.Width(),s=i.Y()+i.Height(),r=i.X(),n=i.Y()+i.Height(),h=this.edgeClip(o,new a.Z(e,s),new a.Z(r,n)),e=i.X()+i.Width(),s=i.Y(),r=i.X()+i.Width(),n=i.Y()+i.Height(),l=this.edgeClip(h,new a.Z(e,s),new a.Z(r,n)),e=i.X(),s=i.Y(),r=i.X()+i.Width(),n=i.Y(),c=this.edgeClip(l,new a.Z(e,s),new a.Z(r,n)),c},edgeClip(t,i,e){let s,r,n,o,a=[],l=t.size();for(r=t.indexValue(l-1),s=0;s<l;s++)n=t.indexValue(s),this.isInsideEdge(n,i,e)?(this.isInsideEdge(r,i,e)||(o=this.intersect(r,n,i,e),a.push(o)),a.push(n)):this.isInsideEdge(r,i,e)&&(o=this.intersect(r,n,i,e),a.push(o)),r=n;return new h.Z(a)},isInsideEdge(t,i,e){if(i.x>e.x){if(t.y<=i.y)return!0}else if(i.x<e.x){if(t.y>=i.y)return!0}else if(i.y<e.y){if(t.x<=i.x)return!0}else if(i.y>e.y&&t.x>=i.x)return!0;return!1},intersect(t,i,e,s){let r,n,o;return e.y==s.y?(r=(i.x-t.x)/(i.y-t.y),n=t.x+Math.floor((e.y-t.y)*r),o=e.y):(r=(i.y-t.y)/(i.x-t.x),n=e.x,o=t.y+Math.floor((e.x-t.x)*r)),new a.Z(n,o)},SetUI(){this.$refs.page.SetUI()}},mounted(){this.Init(),this.SetUI()}},p=e(89);const u=(0,p.Z)(c,[["render",r]]);var d=u}}]);
//# sourceMappingURL=106.90014e45.js.map