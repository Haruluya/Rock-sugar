"use strict";(self["webpackChunkrock_sugar"]=self["webpackChunkrock_sugar"]||[]).push([[713],{7713:function(e,t,r){r.r(t),r.d(t,{default:function(){return f}});var n=r(3396);const o=e=>((0,n.dD)("data-v-7fbb2438"),e=e(),(0,n.Cn)(),e),a={class:"pageContainer"},i={class:"webglContainer"},s=o((()=>(0,n._)("div",{id:"uiContainer"},[(0,n._)("div",{id:"ui"})],-1)));function u(e,t,r,o,u,l){const _=(0,n.up)("nano_canvas"),c=(0,n.up)("nano_webgl_des_panel");return(0,n.wg)(),(0,n.iD)("div",a,[(0,n._)("div",i,[(0,n.Wm)(_,{prop_vertex_shader_source:u.vertexShaderSource,prop_fragment_shader_source:u.fragmentShaderSource},null,8,["prop_vertex_shader_source","prop_fragment_shader_source"]),s]),(0,n.Wm)(c,{prop_category:u.desData.category,prop_name:u.desData.name,prop_button_content:u.desData.buttonContent,prop_title:u.desData.title,prop_content:u.desData.content,onHandleClick:l.handleClick},null,8,["prop_category","prop_name","prop_button_content","prop_title","prop_content","onHandleClick"])])}r(8675),r(3408),r(4590);var l=r(9022),_="\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec2 u_resolution;\nvarying vec2 v_texCoord;\n\nvoid main() {\n    vec2 zeroToOne = a_position / u_resolution;\n    vec2 zeroToTwo = zeroToOne * 2.0;\n    vec2 clipSpace = zeroToTwo - 1.0;\n    gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n    v_texCoord = a_texCoord;\n}\n",c="\nprecision mediump float;\n                \nuniform sampler2D u_image;\nuniform vec2 u_textureSize;\nuniform float u_kernel[9];\nuniform float u_kernelWeight;\n\nvarying vec2 v_texCoord;\n\nvoid main() {\n    vec2 onePixel = vec2(1.0, 1.0) / u_textureSize;\n    vec4 colorSum =\n        texture2D(u_image, v_texCoord + onePixel * vec2(-1, -1)) * u_kernel[0] +\n        texture2D(u_image, v_texCoord + onePixel * vec2( 0, -1)) * u_kernel[1] +\n        texture2D(u_image, v_texCoord + onePixel * vec2( 1, -1)) * u_kernel[2] +\n        texture2D(u_image, v_texCoord + onePixel * vec2(-1,  0)) * u_kernel[3] +\n        texture2D(u_image, v_texCoord + onePixel * vec2( 0,  0)) * u_kernel[4] +\n        texture2D(u_image, v_texCoord + onePixel * vec2( 1,  0)) * u_kernel[5] +\n        texture2D(u_image, v_texCoord + onePixel * vec2(-1,  1)) * u_kernel[6] +\n        texture2D(u_image, v_texCoord + onePixel * vec2( 0,  1)) * u_kernel[7] +\n        texture2D(u_image, v_texCoord + onePixel * vec2( 1,  1)) * u_kernel[8] ;\n    gl_FragColor = vec4((colorSum / u_kernelWeight).rgb, 1);\n}\n",g={texcoord:[0,0,1,0,0,1,0,1,1,0,1,1],kernels:{normal:[0,0,0,0,1,0,0,0,0],gaussianBlur:[.045,.122,.045,.122,.332,.122,.045,.122,.045],gaussianBlur2:[1,2,1,2,4,2,1,2,1],gaussianBlur3:[0,1,0,1,1,1,0,1,0],unsharpen:[-1,-1,-1,-1,9,-1,-1,-1,-1],sharpness:[0,-1,0,-1,5,-1,0,-1,0],sharpen:[-1,-1,-1,-1,16,-1,-1,-1,-1],edgeDetect:[-.125,-.125,-.125,-.125,1,-.125,-.125,-.125,-.125],edgeDetect2:[-1,-1,-1,-1,8,-1,-1,-1,-1],edgeDetect3:[-5,0,0,0,0,0,0,0,5],edgeDetect4:[-1,-1,-1,0,0,0,1,1,1],edgeDetect5:[-1,-1,-1,2,2,2,-1,-1,-1],edgeDetect6:[-5,-5,-5,-5,39,-5,-5,-5,-5],sobelHorizontal:[1,2,1,0,0,0,-1,-2,-1],sobelVertical:[1,0,-1,2,0,-2,1,0,-1],previtHorizontal:[1,1,1,0,0,0,-1,-1,-1],previtVertical:[1,0,-1,1,0,-1,1,0,-1],boxBlur:[.111,.111,.111,.111,.111,.111,.111,.111,.111],triangleBlur:[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625],emboss:[-2,-1,0,-1,1,1,0,1,2]}};const h={category:"Webgl",name:"ImageProcess",buttonContent:"查看源码",title:"图像处理",content:"Image processing can change people's appearance and judge people's life and death."},d=g.texcoord,m=g.kernels;var p={name:"ImageProcess",data(){return{gl:null,canvas:null,program:null,vertexShaderSource:_,fragmentShaderSource:c,desData:h,bufferData:{position:{numComponents:2,data:[]},texCoord:{numComponents:2,data:d}},uniformsData:{u_textureSize:null,u_kernel:[],u_kernelWeight:null,u_resolution:null},bufferInfo:null,uniformSetters:null,attribSetters:null,img:null,texture:null,kernels:m,selection:"normal"}},mounted(){this.LoadImg(),this.SetUI()},methods:{LoadImg(){const e=new Image;e.src=l,this.img=e,e.onload=()=>{this.position=this.getImgPosition(canvas,this.img.width,this.img.height),this.Init()}},Init(){const{gl:e,canvas:t}=haruluya_webgl_utils.initWebglContext("canvas");this.gl=e,this.canvas=t,this.program=haruluya_webgl_utils.createProgramFromScripts(e,["vertex-shader","fragment-shader"]),this.bufferData.position.data=this.position,this.bufferInfo=haruluya_webgl_utils.createBufferInfoFromArrays(e,this.bufferData),this.uniformSetters=haruluya_webgl_utils.createUniformSetters(e,this.program),this.attribSetters=haruluya_webgl_utils.createAttributeSetters(e,this.program),this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this.img),this.Render(this.selection)},Render(e){const t=this.gl;haruluya_webgl_utils.resizeCanvasToDisplaySize(t.canvas),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT),t.useProgram(this.program),this.uniformsData.u_resolution=[t.canvas.width,t.canvas.height],this.uniformsData.u_textureSize=[this.img.width,this.img.height],this.uniformsData.u_kernel=this.kernels[e],this.uniformsData.u_kernelWeight=this.computeKernelWeight(this.kernels[e]),haruluya_webgl_utils.setBuffersAndAttributes(t,this.attribSetters,this.bufferInfo),haruluya_webgl_utils.setUniforms(this.uniformSetters,this.uniformsData),t.drawArrays(t.TRIANGLES,0,6)},SetUI(){const e=this.Render;haruluya_webgl_utils.setDropDownBox(this.kernels,"ui",(function(t){e(this.options[this.selectedIndex].value)}))},Destory(){},handleClick(){window.location.href="https://github.com/Haruluya/Rock-sugar/blob/master/rock-sugar/src/pages/WebglDemo/ImageProcess/index.vue"},computeKernelWeight(e){let t=e.reduce((function(e,t){return e+t}));return t<=0?1:t},getImgPosition(e,t,r){t=t>300?300:t,r=r>300?300:r;const n=e.getBoundingClientRect().width/2-t/2,o=e.getBoundingClientRect().height/2-r/2;let a=n,i=n+t,s=o,u=o+r;return new Float32Array([a,s,i,s,a,u,a,u,i,s,i,u])}},beforeDestory(){this.Destory()}},v=r(89);const x=(0,v.Z)(p,[["render",u],["__scopeId","data-v-7fbb2438"]]);var f=x},9022:function(e,t,r){e.exports=r.p+"img/haruluya.d6eb9f82.jpg"}}]);
//# sourceMappingURL=713.f8771cf6.js.map