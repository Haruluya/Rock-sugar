"use strict";(self["webpackChunkrock_sugar"]=self["webpackChunkrock_sugar"]||[]).push([[986],{6986:function(t,i,e){e.r(i),e.d(i,{default:function(){return w}});var a=e(3396);const r={class:"pageContainer"},l={class:"webglContainer"},o={id:"uiContainer"},n={id:"ui"};function s(t,i,e,s,u,_){const h=(0,a.up)("nano_canvas"),c=(0,a.up)("ui"),g=(0,a.up)("nano_webgl_des_panel");return(0,a.wg)(),(0,a.iD)("div",r,[(0,a._)("div",l,[(0,a.Wm)(h,{prop_vertex_shader_source:u.vertexShaderSource,prop_fragment_shader_source:u.fragmentShaderSource},null,8,["prop_vertex_shader_source","prop_fragment_shader_source"]),(0,a._)("div",o,[(0,a._)("div",n,[(0,a.Wm)(c,{id:"x"}),(0,a.Wm)(c,{id:"y"}),(0,a.Wm)(c,{id:"z"}),(0,a.Wm)(c,{id:"angleX"}),(0,a.Wm)(c,{id:"angleY"}),(0,a.Wm)(c,{id:"angleZ"}),(0,a.Wm)(c,{id:"scaleX"}),(0,a.Wm)(c,{id:"scaleY"}),(0,a.Wm)(c,{id:"scaleZ"}),(0,a.Wm)(c,{id:"shininess"}),(0,a.Wm)(c,{id:"lightColor"}),(0,a.Wm)(c,{id:"fRotation"}),(0,a.Wm)(c,{id:"lightRotationX"}),(0,a.Wm)(c,{id:"lightRotationY"}),(0,a.Wm)(c,{id:"innerLimit"}),(0,a.Wm)(c,{id:"outerLimit"})])])]),(0,a.Wm)(g,{prop_category:u.desData.category,prop_name:u.desData.name,prop_button_content:u.desData.buttonContent,prop_title:u.desData.title,prop_content:u.desData.content,onHandleClick:_.handleClick},null,8,["prop_category","prop_name","prop_button_content","prop_title","prop_content","onHandleClick"])])}var u="\nattribute vec4 a_position;\nattribute vec3 a_normal;\nattribute vec4 a_color;\nuniform vec3 u_lightWorldPosition;\nuniform vec3 u_viewWorldPosition;\nuniform mat4 u_world;\nuniform mat4 u_worldViewProjection;\nuniform mat4 u_worldInverseTranspose;\nvarying vec3 v_normal;\nvarying vec3 v_surfaceToLight;\nvarying vec3 v_surfaceToView;\nvarying vec4 v_color;\nvoid main() {\n    gl_Position = u_worldViewProjection * a_position;\n    v_normal = mat3(u_worldInverseTranspose) * a_normal;\n    vec3 surfaceWorldPosition = (u_world * a_position).xyz;\n    v_surfaceToLight = u_lightWorldPosition - surfaceWorldPosition;\n    v_surfaceToView = u_viewWorldPosition - surfaceWorldPosition;\n    v_color = a_color;\n}\n",_="\nprecision mediump float;\nvarying vec3 v_normal;\nvarying vec3 v_surfaceToLight;\nvarying vec3 v_surfaceToView;\n\nvarying vec4 v_color;\nuniform float u_shininess;\nuniform vec3 u_lightDirection;\nuniform float u_innerLimit;          // in dot space\nuniform float u_outerLimit;          // in dot space\nvoid main() {\n    vec3 normal = normalize(v_normal);\n    vec3 surfaceToLightDirection = normalize(v_surfaceToLight);\n    vec3 surfaceToViewDirection = normalize(v_surfaceToView);\n    vec3 halfVector = normalize(surfaceToLightDirection + surfaceToViewDirection);\n    float dotFromDirection = dot(surfaceToLightDirection,\n                                -u_lightDirection);\n    float inLight = smoothstep(u_outerLimit, u_innerLimit, dotFromDirection);\n    float light = inLight * dot(normal, surfaceToLightDirection);\n    float specular = inLight * pow(dot(normal, halfVector), u_shininess);\n\n    gl_FragColor = v_color;\n    gl_FragColor.rgb *= light;\n    gl_FragColor.rgb += specular;\n}\n\n",h=(e(8675),e(3408),e(4590),{position:new Float32Array([200,50,0,0,50,0,0,150,0,0,150,0,200,150,0,200,50,0,200,50,100,0,50,100,0,50,0,0,50,0,200,50,0,200,50,100,200,50,0,200,150,0,200,150,100,200,150,100,200,50,100,200,50,0,0,50,0,0,50,100,0,150,100,0,150,100,0,150,0,0,50,0,0,150,0,0,150,100,200,150,100,200,150,100,200,150,0,0,150,0,200,50,100,200,150,100,0,150,100,0,150,100,0,50,100,200,50,100]),color:new Uint8Array([0,59,252,0,80,252,0,218,252,0,218,252,0,80,252,0,59,252,252,0,0,150,0,0,0,0,0,0,0,0,150,0,0,252,0,0,252,227,103,150,227,103,0,227,103,0,227,103,150,227,103,252,227,103,252,227,103,150,227,103,0,227,103,0,227,103,150,227,103,252,227,103,252,0,0,150,0,0,0,0,0,0,0,0,150,0,0,252,0,0,0,59,252,0,80,252,0,218,252,0,218,252,0,80,252,0,59,252]),normal:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1]});const c={category:"Webgl",name:"SpotLight",buttonContent:"查看源码",title:"聚光灯",content:"potlight will never be on me."},g=h.position,m=h.color,d=h.normal;var p={name:"SpotLight",data(){return{gl:null,canvas:null,program:null,vertexShaderSource:u,fragmentShaderSource:_,desData:c,bufferData:{position:{data:[]},color:{data:m},normal:{data:d}},uniformsData:{u_shininess:null,u_lightDirection:null,u_innerLimit:null,u_outerLimit:null,u_lightWorldPosition:null,u_viewWorldPosition:null,u_world:null,u_worldViewProjection:null,u_worldInverseTranspose:null},bufferInfo:null,uniformSetters:null,attribSetters:null,transfrom:{translation:[0,0,0],rotation:[haruluya_webgl_utils.degToRad(190),haruluya_webgl_utils.degToRad(200),haruluya_webgl_utils.degToRad(360)],scale:[1,.8,1]},perspective:{aspect:0,fieldOfViewRadians:haruluya_webgl_utils.degToRad(60),zNear:1,zFar:2e3},sectionParams:{shininess:10,lightRotationX:0,lightRotationY:0,lightDirection:[0,0,1],lightColor:null,lightPosition:[40,60,120],innerLimit:haruluya_webgl_utils.degToRad(21),outerLimit:haruluya_webgl_utils.degToRad(35)},camera:{target:[0,35,0],position:[100,150,200],up:[0,1,0]}}},mounted(){this.Init(),this.SetUI()},methods:{Init(){const{gl:t,canvas:i}=haruluya_webgl_utils.initWebglContext("canvas");this.gl=t,this.canvas=i,this.program=haruluya_webgl_utils.createProgramFromScripts(t,["vertex-shader","fragment-shader"]),this.perspective.aspect=t.canvas.clientWidth/t.canvas.clientHeight,this.setPosition();var e=haruluya_webgl_utils.lookAt(this.sectionParams.lightPosition,this.camera.target,this.camera.up);e=haruluya_webgl_utils.multiply3d(haruluya_webgl_utils.xRotation(this.sectionParams.lightRotationX),e),e=haruluya_webgl_utils.multiply3d(haruluya_webgl_utils.yRotation(this.sectionParams.lightRotationY),e),this.sectionParams.lightDirection=[-e[8],-e[9],-e[10]],this.bufferInfo=haruluya_webgl_utils.createBufferInfoFromArrays(t,this.bufferData),this.uniformSetters=haruluya_webgl_utils.createUniformSetters(t,this.program),this.attribSetters=haruluya_webgl_utils.createAttributeSetters(t,this.program),this.Render()},Render(){const t=this.gl,i=this.program;haruluya_webgl_utils.resizeCanvasToDisplaySize(t.canvas),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),t.useProgram(i),haruluya_webgl_utils.setBuffersAndAttributes(t,this.attribSetters,this.bufferInfo);let e=haruluya_webgl_utils.lookAt(this.camera.position,this.camera.target,this.camera.up),a=haruluya_webgl_utils.inverse(e),r=haruluya_webgl_utils.perspective(this.perspective.fieldOfViewRadians,this.perspective.aspect,this.perspective.zNear,this.perspective.zFar),l=haruluya_webgl_utils.multiply3d(r,a),o=haruluya_webgl_utils.getTransformMatrix(haruluya_webgl_utils.yRotation(0),this.transfrom),n=haruluya_webgl_utils.multiply3d(l,o),s=haruluya_webgl_utils.inverse(o),u=haruluya_webgl_utils.transpose(s);this.uniformsData.u_worldViewProjection=n,this.uniformsData.u_worldInverseTranspose=u,this.uniformsData.u_world=o,this.uniformsData.u_lightWorldPosition=this.sectionParams.lightPosition,this.uniformsData.u_viewWorldPosition=this.camera.position,this.uniformsData.u_shininess=this.sectionParams.shininess,this.uniformsData.u_lightDirection=this.sectionParams.lightDirection,this.uniformsData.u_innerLimit=Math.cos(this.sectionParams.innerLimit),this.uniformsData.u_outerLimit=Math.cos(this.sectionParams.outerLimit);var _=haruluya_webgl_utils.lookAt(this.sectionParams.lightPosition,this.camera.target,this.camera.up);_=haruluya_webgl_utils.multiply3d(haruluya_webgl_utils.xRotation(this.sectionParams.lightRotationX),_),_=haruluya_webgl_utils.multiply3d(haruluya_webgl_utils.yRotation(this.sectionParams.lightRotationY),_),this.sectionParams.lightDirection=[-_[8],-_[9],-_[10]],haruluya_webgl_utils.setUniforms(this.uniformSetters,this.uniformsData),t.drawArrays(t.TRIANGLES,0,96)},SetUI(){const t=this.gl,i=this.Render;let e=this.sectionParams;const a=function(t,a){e.lightRotationX=a.value,i()},r=function(t,a){e.lightRotationY=a.value,i()},l=function(t,a){e.innerLimit=haruluya_webgl_utils.degToRad(a.value),i()},o=function(t,a){e.outerLimit=haruluya_webgl_utils.degToRad(a.value),i()};let n=this.transfrom;const s=function(t){return function(e,a){n.translation[t]=a.value,i()}},u=function(t){return function(e,a){const r=a.value,l=r*Math.PI/180;n.rotation[t]=l,i()}},_=function(t){return function(e,a){n.scale[t]=a.value,i()}},h=function(t,a){e.shininess=a.value,i()};haruluya_webgl_utils.setupSlider("lightRotationX",{value:e.lightRotationX,slide:a,min:-2,max:2,precision:2,step:.001}),haruluya_webgl_utils.setupSlider("lightRotationY",{value:e.lightRotationY,slide:r,min:-2,max:2,precision:2,step:.001}),haruluya_webgl_utils.setupSlider("innerLimit",{value:haruluya_webgl_utils.radToDeg(e.innerLimit),slide:l,min:0,max:180}),haruluya_webgl_utils.setupSlider("outerLimit",{value:haruluya_webgl_utils.radToDeg(e.outerLimit),slide:o,min:0,max:180}),haruluya_webgl_utils.setupSlider("shininess",{value:e.shininess,slide:h,min:0,max:10}),haruluya_webgl_utils.setupSlider("x",{value:n.translation[0],slide:s(0),max:t.canvas.width}),haruluya_webgl_utils.setupSlider("y",{value:n.translation[1],slide:s(1),max:t.canvas.height}),haruluya_webgl_utils.setupSlider("z",{value:n.translation[2],slide:s(2),max:t.canvas.height}),haruluya_webgl_utils.setupSlider("angleX",{value:haruluya_webgl_utils.radToDeg(n.rotation[0]),slide:u(0),max:360}),haruluya_webgl_utils.setupSlider("angleY",{value:haruluya_webgl_utils.radToDeg(n.rotation[1]),slide:u(1),max:360}),haruluya_webgl_utils.setupSlider("angleZ",{value:haruluya_webgl_utils.radToDeg(n.rotation[2]),slide:u(2),max:360}),haruluya_webgl_utils.setupSlider("scaleX",{value:n.scale[0],slide:_(0),min:-5,max:5,step:.01,precision:2}),haruluya_webgl_utils.setupSlider("scaleY",{value:n.scale[1],slide:_(1),min:-5,max:5,step:.01,precision:2}),haruluya_webgl_utils.setupSlider("scaleZ",{value:n.scale[2],slide:_(2),min:-5,max:5,step:.01,precision:2})},Destory(){},handleClick(){window.location.href="https://github.com/Haruluya/Rock-sugar/blob/master/rock-sugar/src/pages/WebglDemo/Orthographic/index.vue"},setPosition(){let t=haruluya_webgl_utils.xRotation(Math.PI);t=haruluya_webgl_utils.translate3d(t,-50,-75,-15);for(let i=0;i<g.length;i+=3){let e=haruluya_webgl_utils.transformPoint(t,[g[i+0],g[i+1],g[i+2],1]);g[i+0]=e[0],g[i+1]=e[1],g[i+2]=e[2]}this.bufferData.position=g}},beforeDestory(){this.Destory()}},v=e(89);const f=(0,v.Z)(p,[["render",s],["__scopeId","data-v-62cc2148"]]);var w=f}}]);
//# sourceMappingURL=986.4f8d39e0.js.map