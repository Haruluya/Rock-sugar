"use strict";(self["webpackChunkrock_sugar"]=self["webpackChunkrock_sugar"]||[]).push([[919],{3095:function(e,t,n){n.r(t),n.d(t,{default:function(){return P}});var o=n(3396);function i(e,t,n,i,r,a){const s=(0,o.up)("nano_webgl_scene_panel");return(0,o.wg)(),(0,o.j4)(s,{prop_des_data:r.desData,prop_ui_setter:r.uiSetter,prop_section_params:r.sectionParams,ref:"page",onInit:a.Init,onRender:a.Render,onProp_ui_setter:r.uiSetter},null,8,["prop_des_data","prop_ui_setter","prop_section_params","onInit","onRender","onProp_ui_setter"])}var r="\nprecision highp float;\n\n// Passed in from the vertex shader.\nvarying vec3 v_worldPosition;\nvarying vec3 v_worldNormal;\n\n// The texture.\nuniform samplerCube u_texture;\n\n// The position of the camera\nuniform vec3 u_worldCameraPosition;\n\nvoid main() {\n  vec3 worldNormal = normalize(v_worldNormal);\n  vec3 eyeToSurfaceDir = normalize(v_worldPosition - u_worldCameraPosition);\n  vec3 direction = reflect(eyeToSurfaceDir,worldNormal);\n\n  gl_FragColor = textureCube(u_texture, direction);\n}\n\n",a="\nattribute vec4 a_position;\nattribute vec3 a_normal;\n\nuniform mat4 u_projection;\nuniform mat4 u_view;\nuniform mat4 u_world;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_worldNormal;\n\nvoid main() {\n  // Multiply the position by the matrix.\n  gl_Position = u_projection * u_view * u_world * a_position;\n\n  // send the view position to the fragment shader\n  v_worldPosition = (u_world * a_position).xyz;\n\n  // orient the normals and pass to the fragment shader\n  v_worldNormal = mat3(u_world) * a_normal;\n}\n\n",s="\nprecision mediump float;\n\nuniform samplerCube u_skybox;\nuniform mat4 u_viewDirectionProjectionInverse;\n\nvarying vec4 v_position;\nvoid main() {\n  vec4 t = u_viewDirectionProjectionInverse * v_position;\n  gl_FragColor = textureCube(u_skybox, normalize(t.xyz / t.w));\n}\n\n",p="\nattribute vec4 a_position;\nvarying vec4 v_position;\nvoid main() {\n  v_position = a_position;\n  gl_Position = vec4(a_position.xy, 1, 1);\n}\n",g=n.p+"img/left.967a5b0f.jpg",_=n.p+"img/down.0b25909d.jpg",u=n.p+"img/front.6998cf38.jpg",d=n.p+"img/right.0d2529c9.jpg",m=n.p+"img/up.d1070682.jpg",l=n.p+"img/back.482e02a0.jpg",c=(n(8675),n(3408),n(4590),{obj:{position:new Float32Array([-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5]),normal:new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0])},skybox:{position:new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1])}});const h={category:"Webgl",name:"Skybox",buttonContent:"查看源码",title:"天空盒",content:"From the rendering world, you can never see the truth outside the sky box."},E=c.obj.position,v=c.obj.normal,f=c.skybox.position;var b={name:"SpotLight",data(){return{gl:null,desData:h,perspective:{aspect:0,fieldOfViewRadians:HNWUEngine.degToRad(60),zNear:1,zFar:2e3},transform:{translation:[0,0,-0],rotation:[HNWUEngine.degToRad(0),HNWUEngine.degToRad(0),HNWUEngine.degToRad(0)],scale:[1,1,1]},camera:{target:[0,0,0],position:[0,0,2],up:[0,1,0]},sectionParams:{texture:null},page:null,uiSetter:[]}},methods:{Init(){this.page=this.$refs.page,this.gl=this.page.getGL();const e=this.gl;this.page.addProgram("obj",a,r),this.page.addProgram("skybox",p,s),this.page.addComponent("obj","obj"),this.page.addComponent("skybox","skybox"),this.perspective.aspect=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight,this.$refs.page.set3DViewer(this.perspective,this.camera,this.transform),this.page.addBuffer("position",{numComponents:3,data:E},"obj"),this.page.addBuffer("normal",{numComponents:3,data:v},"obj"),this.page.addBuffer("position",{numComponents:2,data:f},"skybox"),this.sectionParams.texture=e.createTexture(),e.bindTexture(e.TEXTURE_CUBE_MAP,this.sectionParams.texture),this.faceInfos(e).forEach((t=>{const{target:n,url:o}=t,i=0,r=e.RGBA,a=512,s=512,p=e.RGBA,g=e.UNSIGNED_BYTE;e.texImage2D(n,i,r,a,s,0,p,g,null);const _=new Image;_.src=o,_.addEventListener("load",(()=>{e.bindTexture(e.TEXTURE_CUBE_MAP,this.sectionParams.texture),e.texImage2D(n,i,r,p,g,_),e.generateMipmap(e.TEXTURE_CUBE_MAP)}))})),e.generateMipmap(e.TEXTURE_CUBE_MAP),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR)},Render(){const e=this.gl;let t=HNWUEngine.lookAt(this.camera.position,this.camera.target,this.camera.up),n=HNWUEngine.inverse(t),o=HNWUEngine.perspective(this.perspective.fieldOfViewRadians,this.perspective.aspect,this.perspective.zNear,this.perspective.zFar),i=HNWUEngine.getTransformMatrix(HNWUEngine.xRotation(0),this.transform);var r=HNWUEngine.copy(n);r[12]=0,r[13]=0,r[14]=0;var a=HNWUEngine.multiply3d(o,r),s=HNWUEngine.inverse(a);this.page.addUniform("u_projection",o,"obj"),this.page.addUniform("u_view",n,"obj"),this.page.addUniform("u_world",i,"obj"),this.page.addUniform("u_worldCameraPosition",this.camera.position,"obj"),this.page.addUniform("u_viewDirectionProjectionInverse",s,"skybox"),this.page.addUniform("u_texture",this.sectionParams.texture,"obj"),this.page.addUniform("u_texture",this.sectionParams.texture,"skybox"),this.page.useProgram(this.page.getComponent("obj").program),e.enable(e.CULL_FACE),e.enable(e.DEPTH_TEST),e.depthFunc(e.LESS),this.page.setSetters("obj"),this.page.drawComponent("obj"),this.page.useProgram(this.page.getComponent("skybox").program),e.enable(e.CULL_FACE),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),this.page.setSetters("skybox"),this.page.drawComponent("skybox")},faceInfos(e){return[{target:e.TEXTURE_CUBE_MAP_POSITIVE_X,url:d},{target:e.TEXTURE_CUBE_MAP_NEGATIVE_X,url:g},{target:e.TEXTURE_CUBE_MAP_POSITIVE_Y,url:_},{target:e.TEXTURE_CUBE_MAP_NEGATIVE_Y,url:m},{target:e.TEXTURE_CUBE_MAP_POSITIVE_Z,url:l},{target:e.TEXTURE_CUBE_MAP_NEGATIVE_Z,url:u}]}},mounted(){}},T=n(89);const U=(0,T.Z)(b,[["render",i]]);var P=U}}]);
//# sourceMappingURL=919.7fdc6997.js.map